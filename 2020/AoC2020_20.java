import static java.util.Arrays.asList;
import static java.util.stream.Collectors.toList;
import static java.util.stream.Collectors.toSet;
import static org.apache.commons.collections4.CollectionUtils.union;

import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.ListIterator;
import java.util.Map;
import java.util.Objects;
import java.util.Set;
import java.util.concurrent.Callable;
import java.util.stream.Stream;

import org.apache.commons.collections4.CollectionUtils;
import org.apache.commons.lang3.mutable.MutableLong;
import org.apache.commons.lang3.tuple.Pair;

public class AoC2020_20 {
	
	private final List<String> inputs;
	private final boolean debug;
	
	private AoC2020_20(String input, boolean debug) {
		this.inputs = asList((input + "\n").split("\\r?\\n"));
		this.debug = debug;
	}

	public static final AoC2020_20 create(String input) {
		return new AoC2020_20(input, false);
	}

	public static final AoC2020_20 createDebug(String input) {
		return new AoC2020_20(input, true);
	}
	
	private void log(Object obj) {
		if (!debug) {
			return;
		}
		System.out.println(obj);
	}
	
	public Image parse(List<String> inputs) {
		final List<List<String>> blocks = new ArrayList<>();
		int i = 0;
		blocks.add(new ArrayList<String>());
		for (String input: inputs) {
			if (input.isEmpty()) {
				blocks.add(new ArrayList<String>());
				i++;				
			} else {
				blocks.get(i).add(input);				
			}
		}
		
		final Set<Tile> tiles = new HashSet<>();
		for (List<String> block : blocks) {
			Integer id = null;
			final List<char[]> grid = new ArrayList<>();
			for (String line : block) {
				if (line.startsWith("Tile ")) {
					id = Integer.valueOf(line.substring("Tile ".length(), line.length() - 1));
				} else {
					grid.add(line.toCharArray());
				}
			}			
			tiles.add(new Tile(id, Tile.toGrid(grid)));
		}
		return new Image(tiles);
	}
	
	public long solvePart1() {
		final Image image = parse(inputs);		
		image.getTiles().forEach(this::log);
		return Math.prod(image.findCorners().stream().map(Tile::getId).collect(toSet()));
	}
	
	public long solvePart2() {
		final Image image = parse(inputs);		
		image.lockTopLeftCorner();
		return 0L;
	}
	
	public static <V> void lap(String prefix, Callable<V> callable) throws Exception {
		long timerStart = System.nanoTime();
		final V answer = callable.call();
		long timeSpent = (System.nanoTime() - timerStart) / 1000;
		double time;
		String unit;
		if (timeSpent < 1000) {
			time = timeSpent;
			unit = "µs";
		} else if (timeSpent < 1000000) {
			time = timeSpent / 1000.0;
			unit = "ms";
		} else {
			time = timeSpent / 1000000.0;
			unit = "s";
		}
		System.out.println(String.format("%s : %s, took: %.3f %s", prefix, answer, time, unit));
	}
	
	public static void main(String[] args) throws Exception {
		assert AoC2020_20.createDebug(TEST).solvePart1() == 20899048083289L;
		lap("Part 1", () -> AoC2020_20.create(INPUT).solvePart1());
		assert AoC2020_20.createDebug(TEST).solvePart2() == 273L;
	}

	private static final String TEST = 
			"Tile 2311:\r\n" + 
			"..##.#..#.\r\n" + 
			"##..#.....\r\n" + 
			"#...##..#.\r\n" + 
			"####.#...#\r\n" + 
			"##.##.###.\r\n" + 
			"##...#.###\r\n" + 
			".#.#.#..##\r\n" + 
			"..#....#..\r\n" + 
			"###...#.#.\r\n" + 
			"..###..###\r\n" + 
			"\r\n" + 
			"Tile 1951:\r\n" + 
			"#.##...##.\r\n" + 
			"#.####...#\r\n" + 
			".....#..##\r\n" + 
			"#...######\r\n" + 
			".##.#....#\r\n" + 
			".###.#####\r\n" + 
			"###.##.##.\r\n" + 
			".###....#.\r\n" + 
			"..#.#..#.#\r\n" + 
			"#...##.#..\r\n" + 
			"\r\n" + 
			"Tile 1171:\r\n" + 
			"####...##.\r\n" + 
			"#..##.#..#\r\n" + 
			"##.#..#.#.\r\n" + 
			".###.####.\r\n" + 
			"..###.####\r\n" + 
			".##....##.\r\n" + 
			".#...####.\r\n" + 
			"#.##.####.\r\n" + 
			"####..#...\r\n" + 
			".....##...\r\n" + 
			"\r\n" + 
			"Tile 1427:\r\n" + 
			"###.##.#..\r\n" + 
			".#..#.##..\r\n" + 
			".#.##.#..#\r\n" + 
			"#.#.#.##.#\r\n" + 
			"....#...##\r\n" + 
			"...##..##.\r\n" + 
			"...#.#####\r\n" + 
			".#.####.#.\r\n" + 
			"..#..###.#\r\n" + 
			"..##.#..#.\r\n" + 
			"\r\n" + 
			"Tile 1489:\r\n" + 
			"##.#.#....\r\n" + 
			"..##...#..\r\n" + 
			".##..##...\r\n" + 
			"..#...#...\r\n" + 
			"#####...#.\r\n" + 
			"#..#.#.#.#\r\n" + 
			"...#.#.#..\r\n" + 
			"##.#...##.\r\n" + 
			"..##.##.##\r\n" + 
			"###.##.#..\r\n" + 
			"\r\n" + 
			"Tile 2473:\r\n" + 
			"#....####.\r\n" + 
			"#..#.##...\r\n" + 
			"#.##..#...\r\n" + 
			"######.#.#\r\n" + 
			".#...#.#.#\r\n" + 
			".#########\r\n" + 
			".###.#..#.\r\n" + 
			"########.#\r\n" + 
			"##...##.#.\r\n" + 
			"..###.#.#.\r\n" + 
			"\r\n" + 
			"Tile 2971:\r\n" + 
			"..#.#....#\r\n" + 
			"#...###...\r\n" + 
			"#.#.###...\r\n" + 
			"##.##..#..\r\n" + 
			".#####..##\r\n" + 
			".#..####.#\r\n" + 
			"#..#.#..#.\r\n" + 
			"..####.###\r\n" + 
			"..#.#.###.\r\n" + 
			"...#.#.#.#\r\n" + 
			"\r\n" + 
			"Tile 2729:\r\n" + 
			"...#.#.#.#\r\n" + 
			"####.#....\r\n" + 
			"..#.#.....\r\n" + 
			"....#..#.#\r\n" + 
			".##..##.#.\r\n" + 
			".#.####...\r\n" + 
			"####.#.#..\r\n" + 
			"##.####...\r\n" + 
			"##..#.##..\r\n" + 
			"#.##...##.\r\n" + 
			"\r\n" + 
			"Tile 3079:\r\n" + 
			"#.#.#####.\r\n" + 
			".#..######\r\n" + 
			"..#.......\r\n" + 
			"######....\r\n" + 
			"####.#..#.\r\n" + 
			".#...#.##.\r\n" + 
			"#.#####.##\r\n" + 
			"..#.###...\r\n" + 
			"..#.......\r\n" + 
			"..#.###...";
	
	private static final String INPUT =
			"Tile 2411:\r\n" + 
			".#.##..#.#\r\n" + 
			".#.......#\r\n" + 
			".##...#.#.\r\n" + 
			"......#...\r\n" + 
			"#.#.......\r\n" + 
			"##.....#.#\r\n" + 
			"#..#...#..\r\n" + 
			"##........\r\n" + 
			"##....#...\r\n" + 
			"##..#.##.#\r\n" + 
			"\r\n" + 
			"Tile 1997:\r\n" + 
			"#.#......#\r\n" + 
			".#......##\r\n" + 
			"#.##..#..#\r\n" + 
			"...#..#.#.\r\n" + 
			".#.#...#..\r\n" + 
			"#.........\r\n" + 
			"..#..#....\r\n" + 
			"#.#..#.##.\r\n" + 
			"#..##.....\r\n" + 
			"#...#.#.#.\r\n" + 
			"\r\n" + 
			"Tile 1427:\r\n" + 
			"#...#..#..\r\n" + 
			"..##.....#\r\n" + 
			"..#...####\r\n" + 
			"#..#.#...#\r\n" + 
			"..#.#.#..#\r\n" + 
			"..####....\r\n" + 
			"#.#.###.#.\r\n" + 
			"......#...\r\n" + 
			"#.........\r\n" + 
			"#.#.##...#\r\n" + 
			"\r\n" + 
			"Tile 2161:\r\n" + 
			"###.####.#\r\n" + 
			"#....###.#\r\n" + 
			"#.#......#\r\n" + 
			"..#....#..\r\n" + 
			"...#.....#\r\n" + 
			".#..#...##\r\n" + 
			"#.#.....##\r\n" + 
			"#..#......\r\n" + 
			".....#.#..\r\n" + 
			"...###.#.#\r\n" + 
			"\r\n" + 
			"Tile 1321:\r\n" + 
			"###...#.#.\r\n" + 
			".#...#..##\r\n" + 
			".#.......#\r\n" + 
			"..........\r\n" + 
			"#.#.......\r\n" + 
			"....#.....\r\n" + 
			"######....\r\n" + 
			"#.....#...\r\n" + 
			"##.......#\r\n" + 
			"#.###..###\r\n" + 
			"\r\n" + 
			"Tile 1181:\r\n" + 
			".#..#..###\r\n" + 
			"###...#.##\r\n" + 
			"#.........\r\n" + 
			"....###..#\r\n" + 
			"#.#...#..#\r\n" + 
			"#....###..\r\n" + 
			"##..##...#\r\n" + 
			"#....##.##\r\n" + 
			"#.......#.\r\n" + 
			"###.##...#\r\n" + 
			"\r\n" + 
			"Tile 2749:\r\n" + 
			"#####..##.\r\n" + 
			"##........\r\n" + 
			"......#.#.\r\n" + 
			"#..#...#.#\r\n" + 
			".....##.#.\r\n" + 
			".....#...#\r\n" + 
			"#.........\r\n" + 
			"#........#\r\n" + 
			"....#..#.#\r\n" + 
			".#..#...#.\r\n" + 
			"\r\n" + 
			"Tile 3911:\r\n" + 
			"##...#####\r\n" + 
			"#...#..#.#\r\n" + 
			".##...#..#\r\n" + 
			"#...#.....\r\n" + 
			"#..#.#...#\r\n" + 
			"..#......#\r\n" + 
			"#.#.......\r\n" + 
			"....##..#.\r\n" + 
			"..#.#..##.\r\n" + 
			"####.#..#.\r\n" + 
			"\r\n" + 
			"Tile 3257:\r\n" + 
			"#..#.##...\r\n" + 
			".#.....#.#\r\n" + 
			"##.#.....#\r\n" + 
			"##.#.#....\r\n" + 
			"#..##..#..\r\n" + 
			"........##\r\n" + 
			"#.##...#.#\r\n" + 
			"#.#..#...#\r\n" + 
			"........##\r\n" + 
			".##.####.#\r\n" + 
			"\r\n" + 
			"Tile 2237:\r\n" + 
			".###.#####\r\n" + 
			"....#....#\r\n" + 
			".......###\r\n" + 
			"#........#\r\n" + 
			"..#.......\r\n" + 
			".#.#......\r\n" + 
			"#...##...#\r\n" + 
			"#.....#.#.\r\n" + 
			"#...#.....\r\n" + 
			"####.#####\r\n" + 
			"\r\n" + 
			"Tile 2389:\r\n" + 
			"#.#.###...\r\n" + 
			"#.#.#...##\r\n" + 
			"......#...\r\n" + 
			".####....#\r\n" + 
			"..#..#..#.\r\n" + 
			"#.......##\r\n" + 
			"..###....#\r\n" + 
			"#........#\r\n" + 
			"#....##...\r\n" + 
			"..#.#..##.\r\n" + 
			"\r\n" + 
			"Tile 3209:\r\n" + 
			"..##.#####\r\n" + 
			".........#\r\n" + 
			"##..#.##..\r\n" + 
			"...#.#...#\r\n" + 
			"....#.#..#\r\n" + 
			"#...#.....\r\n" + 
			"#.#.#.....\r\n" + 
			"#...#....#\r\n" + 
			"#.#......#\r\n" + 
			"...#..####\r\n" + 
			"\r\n" + 
			"Tile 2579:\r\n" + 
			"#...#.##..\r\n" + 
			"....##.###\r\n" + 
			"#......###\r\n" + 
			".......#..\r\n" + 
			"##...#....\r\n" + 
			"#.#......#\r\n" + 
			".##.#....#\r\n" + 
			".#.......#\r\n" + 
			"#...#.....\r\n" + 
			"##..#.##..\r\n" + 
			"\r\n" + 
			"Tile 2087:\r\n" + 
			".###.##.#.\r\n" + 
			".##...##.#\r\n" + 
			"..####.#.#\r\n" + 
			"...#......\r\n" + 
			"...#......\r\n" + 
			"......#..#\r\n" + 
			"#.##......\r\n" + 
			".#.#.#.#..\r\n" + 
			"....##..##\r\n" + 
			"...##.#..#\r\n" + 
			"\r\n" + 
			"Tile 3517:\r\n" + 
			"###.#...##\r\n" + 
			"#.........\r\n" + 
			"#.....#...\r\n" + 
			"###..#.#..\r\n" + 
			"##......#.\r\n" + 
			"..#....#.#\r\n" + 
			"#.....#...\r\n" + 
			"..#...#.##\r\n" + 
			"##...#.#..\r\n" + 
			"##..##.###\r\n" + 
			"\r\n" + 
			"Tile 3347:\r\n" + 
			"##.#..#...\r\n" + 
			".........#\r\n" + 
			"..........\r\n" + 
			".#.#.....#\r\n" + 
			"..........\r\n" + 
			"....#..#.#\r\n" + 
			"#........#\r\n" + 
			"##.#...#.#\r\n" + 
			"....#..#..\r\n" + 
			"##.#.#....\r\n" + 
			"\r\n" + 
			"Tile 2711:\r\n" + 
			".##.#.#...\r\n" + 
			"...#.#....\r\n" + 
			"..........\r\n" + 
			"#......###\r\n" + 
			"..##......\r\n" + 
			"#.........\r\n" + 
			"#..#..##..\r\n" + 
			".##...##..\r\n" + 
			"#......#..\r\n" + 
			"#..#.##.#.\r\n" + 
			"\r\n" + 
			"Tile 3877:\r\n" + 
			"###.#..#.#\r\n" + 
			"#...##...#\r\n" + 
			"..#.#..#.#\r\n" + 
			"##......##\r\n" + 
			".#........\r\n" + 
			"##..#....#\r\n" + 
			"..###..#.#\r\n" + 
			"#.#.......\r\n" + 
			"#.#......#\r\n" + 
			"...###.###\r\n" + 
			"\r\n" + 
			"Tile 1721:\r\n" + 
			"###...##.#\r\n" + 
			"......#..#\r\n" + 
			".##.##....\r\n" + 
			"....##.#..\r\n" + 
			"##..#..#..\r\n" + 
			"###..#..#.\r\n" + 
			"####..##.#\r\n" + 
			"#.#.#....#\r\n" + 
			".......#.#\r\n" + 
			"#..##....#\r\n" + 
			"\r\n" + 
			"Tile 3457:\r\n" + 
			".#.#..##.#\r\n" + 
			"..##.#.#..\r\n" + 
			"##...#...#\r\n" + 
			"...#......\r\n" + 
			"..#....##.\r\n" + 
			"#...#.#..#\r\n" + 
			"..#.......\r\n" + 
			"...#......\r\n" + 
			"........#.\r\n" + 
			".#.#.##..#\r\n" + 
			"\r\n" + 
			"Tile 1231:\r\n" + 
			".#.......#\r\n" + 
			"#........#\r\n" + 
			"#..#..#...\r\n" + 
			"..#......#\r\n" + 
			".....#....\r\n" + 
			"#.........\r\n" + 
			"#...#..#.#\r\n" + 
			".....#..#.\r\n" + 
			".#.#....#.\r\n" + 
			"###...##..\r\n" + 
			"\r\n" + 
			"Tile 1901:\r\n" + 
			".###.#.#.#\r\n" + 
			"...##.....\r\n" + 
			"#......#.#\r\n" + 
			"...##.....\r\n" + 
			"....#.....\r\n" + 
			"#.........\r\n" + 
			"..#......#\r\n" + 
			"##.....#..\r\n" + 
			"#.........\r\n" + 
			"#..##..###\r\n" + 
			"\r\n" + 
			"Tile 3329:\r\n" + 
			"#..#..#.#.\r\n" + 
			"....#.....\r\n" + 
			"###.....##\r\n" + 
			".........#\r\n" + 
			"##..#.....\r\n" + 
			"#.......##\r\n" + 
			"#..#.....#\r\n" + 
			"#..#.#..#.\r\n" + 
			"...#......\r\n" + 
			"...#...##.\r\n" + 
			"\r\n" + 
			"Tile 1291:\r\n" + 
			"..#....#.#\r\n" + 
			"#.#...##.#\r\n" + 
			"#..#....##\r\n" + 
			"#..###...#\r\n" + 
			"#...#.#...\r\n" + 
			"####......\r\n" + 
			"#.....##.#\r\n" + 
			"#.#..#....\r\n" + 
			"##....#..#\r\n" + 
			"#.###.#...\r\n" + 
			"\r\n" + 
			"Tile 1481:\r\n" + 
			"#..#...##.\r\n" + 
			"....#..#..\r\n" + 
			"...##.....\r\n" + 
			"#..#..##..\r\n" + 
			"###.#..##.\r\n" + 
			"##.#.##...\r\n" + 
			"#..#.....#\r\n" + 
			"#......#.#\r\n" + 
			"#.#....#..\r\n" + 
			".#..#..#.#\r\n" + 
			"\r\n" + 
			"Tile 2063:\r\n" + 
			".###..#..#\r\n" + 
			"...#......\r\n" + 
			"#..#.....#\r\n" + 
			"#..#..#...\r\n" + 
			".....#.###\r\n" + 
			"...#......\r\n" + 
			"#.#.....#.\r\n" + 
			"#........#\r\n" + 
			".#...#...#\r\n" + 
			"##.#....##\r\n" + 
			"\r\n" + 
			"Tile 2297:\r\n" + 
			".#..#..#.#\r\n" + 
			"#..#......\r\n" + 
			"#......#.#\r\n" + 
			"#.#..###.#\r\n" + 
			"..........\r\n" + 
			"##..#.#.##\r\n" + 
			"#......#..\r\n" + 
			"#....#.#.#\r\n" + 
			"#........#\r\n" + 
			".#..###...\r\n" + 
			"\r\n" + 
			"Tile 2731:\r\n" + 
			"..#.......\r\n" + 
			"......#...\r\n" + 
			"#..#...#..\r\n" + 
			"..........\r\n" + 
			"#..#...#..\r\n" + 
			"#.#..#..##\r\n" + 
			"##..#..##.\r\n" + 
			"..........\r\n" + 
			"#.##..#...\r\n" + 
			"##....##..\r\n" + 
			"\r\n" + 
			"Tile 1453:\r\n" + 
			"....#.##.#\r\n" + 
			"#..#..##.#\r\n" + 
			"##.#.#....\r\n" + 
			"#..##.#...\r\n" + 
			"#......#..\r\n" + 
			"#......###\r\n" + 
			"...##...#.\r\n" + 
			"#.##......\r\n" + 
			"##........\r\n" + 
			"#######.##\r\n" + 
			"\r\n" + 
			"Tile 1117:\r\n" + 
			".###.#...#\r\n" + 
			".#.#.....#\r\n" + 
			"..#.#...##\r\n" + 
			"#.......#.\r\n" + 
			"#.....#..#\r\n" + 
			"#.###....#\r\n" + 
			"##.#......\r\n" + 
			"#.####..##\r\n" + 
			"#..#..#.#.\r\n" + 
			"##...#####\r\n" + 
			"\r\n" + 
			"Tile 1823:\r\n" + 
			"#.....#...\r\n" + 
			"#......##.\r\n" + 
			".....#.#..\r\n" + 
			"......###.\r\n" + 
			"..#..###.#\r\n" + 
			"....#.##.#\r\n" + 
			".##..#.#.#\r\n" + 
			"#.#.......\r\n" + 
			"##........\r\n" + 
			".#...##..#\r\n" + 
			"\r\n" + 
			"Tile 3163:\r\n" + 
			"..#####.##\r\n" + 
			"...#......\r\n" + 
			"#..###...#\r\n" + 
			"..##..#...\r\n" + 
			".#.......#\r\n" + 
			"..#....#.#\r\n" + 
			"###.#.....\r\n" + 
			"#..#..#...\r\n" + 
			"..##.#....\r\n" + 
			".##.#.#..#\r\n" + 
			"\r\n" + 
			"Tile 2083:\r\n" + 
			"#..######.\r\n" + 
			"....##.#.#\r\n" + 
			".....###.#\r\n" + 
			"#...#..#..\r\n" + 
			"#....#...#\r\n" + 
			"...#...#.#\r\n" + 
			"#..####...\r\n" + 
			"#....#....\r\n" + 
			"#..#....#.\r\n" + 
			"#....#.#..\r\n" + 
			"\r\n" + 
			"Tile 2659:\r\n" + 
			"#.###.#...\r\n" + 
			"...#......\r\n" + 
			"#..#....##\r\n" + 
			"..###.##..\r\n" + 
			"##.......#\r\n" + 
			"#.......#.\r\n" + 
			"#....#...#\r\n" + 
			"#..#.....#\r\n" + 
			"..#.#.....\r\n" + 
			"..#..##.#.\r\n" + 
			"\r\n" + 
			"Tile 2113:\r\n" + 
			".##.######\r\n" + 
			".......###\r\n" + 
			"#....#....\r\n" + 
			"....#..#..\r\n" + 
			"#.##......\r\n" + 
			"####..##..\r\n" + 
			".##..####.\r\n" + 
			"...#....##\r\n" + 
			".#.....#..\r\n" + 
			"#.#.##..##\r\n" + 
			"\r\n" + 
			"Tile 3943:\r\n" + 
			"###..#....\r\n" + 
			".#.....#..\r\n" + 
			"#.........\r\n" + 
			"##....##..\r\n" + 
			"#.#....#.#\r\n" + 
			"#.#.#.....\r\n" + 
			"#....#..#.\r\n" + 
			".##..##..#\r\n" + 
			"....##....\r\n" + 
			".#.#.#####\r\n" + 
			"\r\n" + 
			"Tile 3719:\r\n" + 
			"#...#.#.#.\r\n" + 
			".........#\r\n" + 
			"#.#.......\r\n" + 
			"......#.#.\r\n" + 
			".#...#.#.#\r\n" + 
			".#....####\r\n" + 
			"##........\r\n" + 
			".##..#.#.#\r\n" + 
			"#.........\r\n" + 
			"#.#.#....#\r\n" + 
			"\r\n" + 
			"Tile 1409:\r\n" + 
			"####.#####\r\n" + 
			"#....#....\r\n" + 
			"##.#....#.\r\n" + 
			"#..#......\r\n" + 
			"#....#....\r\n" + 
			"#.#...#...\r\n" + 
			"##.....#..\r\n" + 
			"#.....#..#\r\n" + 
			"......#...\r\n" + 
			"..####...#\r\n" + 
			"\r\n" + 
			"Tile 3547:\r\n" + 
			".#########\r\n" + 
			".#.##...#.\r\n" + 
			"...#..#.#.\r\n" + 
			"#.##...###\r\n" + 
			"#......#..\r\n" + 
			"##...#....\r\n" + 
			"##.#.#.###\r\n" + 
			"##........\r\n" + 
			".....#...#\r\n" + 
			"###.##.##.\r\n" + 
			"\r\n" + 
			"Tile 1123:\r\n" + 
			"...##....#\r\n" + 
			".........#\r\n" + 
			"#...#...##\r\n" + 
			"..........\r\n" + 
			"#.........\r\n" + 
			"#......#.#\r\n" + 
			"#..#.#.#.#\r\n" + 
			"......#..#\r\n" + 
			"#.#...#.##\r\n" + 
			"####.#....\r\n" + 
			"\r\n" + 
			"Tile 2203:\r\n" + 
			".####.#..#\r\n" + 
			"##........\r\n" + 
			"##.......#\r\n" + 
			"#....#....\r\n" + 
			".#......##\r\n" + 
			".#..#..#.#\r\n" + 
			"......#..#\r\n" + 
			"##.###...#\r\n" + 
			"#....#....\r\n" + 
			".##..##.##\r\n" + 
			"\r\n" + 
			"Tile 3511:\r\n" + 
			"#.#..#.#.#\r\n" + 
			"#......###\r\n" + 
			"#..#....#.\r\n" + 
			"#.####....\r\n" + 
			"##...#...#\r\n" + 
			"#.##...##.\r\n" + 
			"##.##..##.\r\n" + 
			".....#...#\r\n" + 
			"#...##...#\r\n" + 
			".#.#..##.#\r\n" + 
			"\r\n" + 
			"Tile 3499:\r\n" + 
			"..#..#.###\r\n" + 
			"#.........\r\n" + 
			"..##..#...\r\n" + 
			"...#.#.#.#\r\n" + 
			"...#.#.#..\r\n" + 
			"#.....##.#\r\n" + 
			"...#......\r\n" + 
			"..#...###.\r\n" + 
			"##..###..#\r\n" + 
			"#.#....###\r\n" + 
			"\r\n" + 
			"Tile 1039:\r\n" + 
			"#.#....##.\r\n" + 
			"#..###.#.#\r\n" + 
			"###.....#.\r\n" + 
			"##..#....#\r\n" + 
			".#....##.#\r\n" + 
			"#..#######\r\n" + 
			".##.#....#\r\n" + 
			"#..#......\r\n" + 
			"##.#...##.\r\n" + 
			"#..#..##.#\r\n" + 
			"\r\n" + 
			"Tile 3323:\r\n" + 
			"#..#.#.##.\r\n" + 
			"#......#..\r\n" + 
			".........#\r\n" + 
			".........#\r\n" + 
			".#....##.#\r\n" + 
			"#.....#..#\r\n" + 
			"#....##...\r\n" + 
			"#...##...#\r\n" + 
			".###...#.#\r\n" + 
			"#...###.##\r\n" + 
			"\r\n" + 
			"Tile 1033:\r\n" + 
			"###...##.#\r\n" + 
			"#..#..#.##\r\n" + 
			".........#\r\n" + 
			".#.#.#..#.\r\n" + 
			"#.........\r\n" + 
			"#......##.\r\n" + 
			"#...#.##.#\r\n" + 
			"..........\r\n" + 
			"###.......\r\n" + 
			".##.#.....\r\n" + 
			"\r\n" + 
			"Tile 2269:\r\n" + 
			"....#.##..\r\n" + 
			"#........#\r\n" + 
			".#..#.#..#\r\n" + 
			"#......#.#\r\n" + 
			"#...#.###.\r\n" + 
			"#..#.....#\r\n" + 
			"....#....#\r\n" + 
			"........##\r\n" + 
			"#.#...#...\r\n" + 
			".#...#.#.#\r\n" + 
			"\r\n" + 
			"Tile 1279:\r\n" + 
			"...##.###.\r\n" + 
			"....#...#.\r\n" + 
			"#..#......\r\n" + 
			"#......##.\r\n" + 
			".#.#....##\r\n" + 
			".#...##..#\r\n" + 
			"..#..#...#\r\n" + 
			"#......#..\r\n" + 
			"#..#....#.\r\n" + 
			".#.#...#.#\r\n" + 
			"\r\n" + 
			"Tile 2549:\r\n" + 
			"..#..###..\r\n" + 
			"..........\r\n" + 
			"........##\r\n" + 
			"....#....#\r\n" + 
			".........#\r\n" + 
			"#...#..#.#\r\n" + 
			"....##..#.\r\n" + 
			".#........\r\n" + 
			"..##..#...\r\n" + 
			"##.##.####\r\n" + 
			"\r\n" + 
			"Tile 2377:\r\n" + 
			"..#.######\r\n" + 
			"..##..#..#\r\n" + 
			"..#.....#.\r\n" + 
			"#.#.#.#...\r\n" + 
			"#....#....\r\n" + 
			"..........\r\n" + 
			"#..##....#\r\n" + 
			"#...####..\r\n" + 
			".......#.#\r\n" + 
			"#.#.#..##.\r\n" + 
			"\r\n" + 
			"Tile 3169:\r\n" + 
			".######.##\r\n" + 
			"#..#..####\r\n" + 
			"#.....#..#\r\n" + 
			"#.##..##.#\r\n" + 
			"....#...##\r\n" + 
			"..##......\r\n" + 
			"#..#...###\r\n" + 
			".....##...\r\n" + 
			"#......###\r\n" + 
			"#.#....#..\r\n" + 
			"\r\n" + 
			"Tile 1979:\r\n" + 
			"###.#.##..\r\n" + 
			"#..#...#..\r\n" + 
			"#..#..#.#.\r\n" + 
			"....##....\r\n" + 
			"#.#.......\r\n" + 
			"#..#.....#\r\n" + 
			"....#.....\r\n" + 
			".#..#..#.#\r\n" + 
			"#.#.###..#\r\n" + 
			"#.####.#.#\r\n" + 
			"\r\n" + 
			"Tile 2131:\r\n" + 
			"..##..#.##\r\n" + 
			"##...#....\r\n" + 
			"#...#.#..#\r\n" + 
			".....#...#\r\n" + 
			".#.#.#..#.\r\n" + 
			"##......#.\r\n" + 
			"......#...\r\n" + 
			"#..##.....\r\n" + 
			".###...###\r\n" + 
			"#...######\r\n" + 
			"\r\n" + 
			"Tile 2531:\r\n" + 
			".#.######.\r\n" + 
			"....#..#.#\r\n" + 
			"...###...#\r\n" + 
			".........#\r\n" + 
			"#....#.#..\r\n" + 
			".....#...#\r\n" + 
			"#...#....#\r\n" + 
			"....#.....\r\n" + 
			"..#.......\r\n" + 
			".....#.##.\r\n" + 
			"\r\n" + 
			"Tile 3167:\r\n" + 
			"####.###..\r\n" + 
			"#..#.....#\r\n" + 
			"#.......##\r\n" + 
			"##..#..#.#\r\n" + 
			"#.........\r\n" + 
			"#.....#.#.\r\n" + 
			"##.......#\r\n" + 
			"...#.#....\r\n" + 
			".........#\r\n" + 
			"######..##\r\n" + 
			"\r\n" + 
			"Tile 3191:\r\n" + 
			"#....#####\r\n" + 
			"#...#.....\r\n" + 
			"..##...#..\r\n" + 
			"#.......#.\r\n" + 
			"#..#.###.#\r\n" + 
			"#####...##\r\n" + 
			"#.#...###.\r\n" + 
			"#.#..#.##.\r\n" + 
			"#.........\r\n" + 
			"#.##.##.#.\r\n" + 
			"\r\n" + 
			"Tile 3767:\r\n" + 
			"#..#..####\r\n" + 
			"#......#..\r\n" + 
			"#.#.##....\r\n" + 
			".....#..#.\r\n" + 
			".#...#.#..\r\n" + 
			"..#.#..###\r\n" + 
			"..##......\r\n" + 
			".###.##..#\r\n" + 
			".##....#.#\r\n" + 
			".##.##..##\r\n" + 
			"\r\n" + 
			"Tile 2633:\r\n" + 
			"##...##.##\r\n" + 
			"#....#..##\r\n" + 
			"...##.#...\r\n" + 
			"#.#.#.....\r\n" + 
			".......###\r\n" + 
			".#...#....\r\n" + 
			"#....#.###\r\n" + 
			".#.....#.#\r\n" + 
			"##....#...\r\n" + 
			"....#..##.\r\n" + 
			"\r\n" + 
			"Tile 2677:\r\n" + 
			"...#.##.#.\r\n" + 
			"......#...\r\n" + 
			".....#....\r\n" + 
			"#......#..\r\n" + 
			"#...#.###.\r\n" + 
			"..#....#.#\r\n" + 
			".........#\r\n" + 
			"#..#...#.#\r\n" + 
			"#.#....###\r\n" + 
			"#.#..#....\r\n" + 
			"\r\n" + 
			"Tile 3989:\r\n" + 
			".###.###.#\r\n" + 
			"#.#..#..##\r\n" + 
			"......#.#.\r\n" + 
			"...#......\r\n" + 
			"..####...#\r\n" + 
			"....###.#.\r\n" + 
			"#.###.#..#\r\n" + 
			"....##....\r\n" + 
			"#.........\r\n" + 
			".#.##.####\r\n" + 
			"\r\n" + 
			"Tile 2897:\r\n" + 
			"####...#.#\r\n" + 
			"..........\r\n" + 
			"#.#.......\r\n" + 
			"#...#.....\r\n" + 
			"......#...\r\n" + 
			"##.###.#..\r\n" + 
			".##..##..#\r\n" + 
			"...##.##..\r\n" + 
			"...##...#.\r\n" + 
			".#.######.\r\n" + 
			"\r\n" + 
			"Tile 3803:\r\n" + 
			"#.#..#.##.\r\n" + 
			"###....#..\r\n" + 
			"#...#..#.#\r\n" + 
			".......###\r\n" + 
			"#.....#..#\r\n" + 
			"##.....#..\r\n" + 
			"##..##..##\r\n" + 
			".#....##.#\r\n" + 
			".###......\r\n" + 
			"#..#.#####\r\n" + 
			"\r\n" + 
			"Tile 1187:\r\n" + 
			".#.#####..\r\n" + 
			".#.#......\r\n" + 
			"#.#.####.#\r\n" + 
			"#...#.....\r\n" + 
			"..#.......\r\n" + 
			".#.....#..\r\n" + 
			"#...#.#..#\r\n" + 
			"#......###\r\n" + 
			"#.##..#..#\r\n" + 
			"#.##.##.##\r\n" + 
			"\r\n" + 
			"Tile 1801:\r\n" + 
			"#.##...#..\r\n" + 
			".##......#\r\n" + 
			"#..####..#\r\n" + 
			"#.##...#.#\r\n" + 
			"#......#.#\r\n" + 
			".....#.#..\r\n" + 
			"..###...#.\r\n" + 
			"..#.#.....\r\n" + 
			"#...#.#...\r\n" + 
			"#....####.\r\n" + 
			"\r\n" + 
			"Tile 2729:\r\n" + 
			".......#..\r\n" + 
			"#.#...#..#\r\n" + 
			"..#.#..#..\r\n" + 
			".....#.#..\r\n" + 
			"#.........\r\n" + 
			"#.#..#....\r\n" + 
			".#.......#\r\n" + 
			"#.#....#.#\r\n" + 
			"#.#...#.##\r\n" + 
			"##.#.###.#\r\n" + 
			"\r\n" + 
			"Tile 2969:\r\n" + 
			".......#.#\r\n" + 
			"##..#....#\r\n" + 
			"#.....#.##\r\n" + 
			"##.....#.#\r\n" + 
			"#..#......\r\n" + 
			".#.#.#....\r\n" + 
			"#....#.#.#\r\n" + 
			"##......##\r\n" + 
			"#......##.\r\n" + 
			".##.##....\r\n" + 
			"\r\n" + 
			"Tile 3079:\r\n" + 
			"...##.####\r\n" + 
			".....#...#\r\n" + 
			"..........\r\n" + 
			"..#.#.....\r\n" + 
			".........#\r\n" + 
			".#...##.##\r\n" + 
			".###.....#\r\n" + 
			"..#.#..##.\r\n" + 
			"#...##...#\r\n" + 
			".##...##..\r\n" + 
			"\r\n" + 
			"Tile 3407:\r\n" + 
			"...#.#.#..\r\n" + 
			".#...##.##\r\n" + 
			"##....#..#\r\n" + 
			".#....#.#.\r\n" + 
			".##.#....#\r\n" + 
			"##......##\r\n" + 
			"#...#...##\r\n" + 
			"#..#.....#\r\n" + 
			"#.....#...\r\n" + 
			"##....##.#\r\n" + 
			"\r\n" + 
			"Tile 3389:\r\n" + 
			"####.#..#.\r\n" + 
			"#..##.....\r\n" + 
			"##...##.#.\r\n" + 
			"#......#..\r\n" + 
			".....#..##\r\n" + 
			"#...##..##\r\n" + 
			"#...##...#\r\n" + 
			"...##..#..\r\n" + 
			"....##..##\r\n" + 
			"#.#...#...\r\n" + 
			"\r\n" + 
			"Tile 1663:\r\n" + 
			"#...##.##.\r\n" + 
			"..#..#.#.#\r\n" + 
			"#.....#.#.\r\n" + 
			"#.........\r\n" + 
			"..##.##..#\r\n" + 
			".....#..#.\r\n" + 
			"#....#....\r\n" + 
			"#.##......\r\n" + 
			".##.#...##\r\n" + 
			".....#...#\r\n" + 
			"\r\n" + 
			"Tile 1787:\r\n" + 
			"#..##....#\r\n" + 
			"......#.#.\r\n" + 
			"#......##.\r\n" + 
			"#.#......#\r\n" + 
			"#....#...#\r\n" + 
			"#.#.......\r\n" + 
			".....#...#\r\n" + 
			"#...#..#..\r\n" + 
			".#......##\r\n" + 
			"..###.#.##\r\n" + 
			"\r\n" + 
			"Tile 2917:\r\n" + 
			"##.#.#####\r\n" + 
			"#..#..#.##\r\n" + 
			"..##..#..#\r\n" + 
			"#..#.##.##\r\n" + 
			"#.#..#....\r\n" + 
			".#.#.##..#\r\n" + 
			".####.....\r\n" + 
			"#..#...#.#\r\n" + 
			"#...#....#\r\n" + 
			".#.#.##..#\r\n" + 
			"\r\n" + 
			"Tile 3067:\r\n" + 
			"##.#.#...#\r\n" + 
			".###..#..#\r\n" + 
			".##.#.#...\r\n" + 
			"#.#.....##\r\n" + 
			"..#.......\r\n" + 
			"#...#...#.\r\n" + 
			"##..#....#\r\n" + 
			"...##..#.#\r\n" + 
			"#.......#.\r\n" + 
			".###...#.#\r\n" + 
			"\r\n" + 
			"Tile 2963:\r\n" + 
			".#..#.#...\r\n" + 
			"#..#.##..#\r\n" + 
			"##........\r\n" + 
			"..#....###\r\n" + 
			"###.#.#...\r\n" + 
			".#.#.#...#\r\n" + 
			"..#.......\r\n" + 
			".#.#.#.#.#\r\n" + 
			"#........#\r\n" + 
			"#..#.#####\r\n" + 
			"\r\n" + 
			"Tile 1753:\r\n" + 
			"###.##.##.\r\n" + 
			"#..#.#..#.\r\n" + 
			".....#...#\r\n" + 
			"#.........\r\n" + 
			"##.#..##.#\r\n" + 
			".#.#.#..#.\r\n" + 
			"#......#.#\r\n" + 
			"...#..#..#\r\n" + 
			"#.#..#..#.\r\n" + 
			"#.#..#.#.#\r\n" + 
			"\r\n" + 
			"Tile 1609:\r\n" + 
			"..#.####.#\r\n" + 
			"#........#\r\n" + 
			"..#.##.#.#\r\n" + 
			"......#.#.\r\n" + 
			".....#....\r\n" + 
			"#.......#.\r\n" + 
			"..........\r\n" + 
			"#.........\r\n" + 
			"#..##.....\r\n" + 
			"##...#.#.#\r\n" + 
			"\r\n" + 
			"Tile 1237:\r\n" + 
			".#.##.##.#\r\n" + 
			"...#.##...\r\n" + 
			"..#......#\r\n" + 
			"##...#..##\r\n" + 
			"...#..#.##\r\n" + 
			".#.#####..\r\n" + 
			"...#.##..#\r\n" + 
			"#....#....\r\n" + 
			"...#..#..#\r\n" + 
			"#..#...##.\r\n" + 
			"\r\n" + 
			"Tile 2267:\r\n" + 
			".#..#..###\r\n" + 
			"...#.#...#\r\n" + 
			"..#..#..##\r\n" + 
			"##....###.\r\n" + 
			"......#..#\r\n" + 
			"..#.......\r\n" + 
			"....#.#.#.\r\n" + 
			"....##...#\r\n" + 
			"###.....##\r\n" + 
			"..##...#.#\r\n" + 
			"\r\n" + 
			"Tile 1777:\r\n" + 
			"...#...###\r\n" + 
			".......#..\r\n" + 
			"##.#..#..#\r\n" + 
			".........#\r\n" + 
			"#....##.#.\r\n" + 
			"#.#..##.#.\r\n" + 
			".#..##.#.#\r\n" + 
			"....#.#.##\r\n" + 
			".###..#.##\r\n" + 
			"......##.#\r\n" + 
			"\r\n" + 
			"Tile 1993:\r\n" + 
			"..#.#..##.\r\n" + 
			"#..#.#.#..\r\n" + 
			".#.#...##.\r\n" + 
			".......#.#\r\n" + 
			"###.#.#...\r\n" + 
			"#..#....#.\r\n" + 
			"#...##...#\r\n" + 
			"#...##...#\r\n" + 
			"......##..\r\n" + 
			"##.#.###.#\r\n" + 
			"\r\n" + 
			"Tile 3571:\r\n" + 
			".###.#...#\r\n" + 
			"...##.....\r\n" + 
			"##..#.....\r\n" + 
			"..#...#..#\r\n" + 
			"......#.##\r\n" + 
			"..#.##...#\r\n" + 
			"##.#..#..#\r\n" + 
			"#.###...##\r\n" + 
			"..####....\r\n" + 
			"..#.#..#..\r\n" + 
			"\r\n" + 
			"Tile 3581:\r\n" + 
			"#.#.#.#.#.\r\n" + 
			"#.#.......\r\n" + 
			"#.#....#..\r\n" + 
			"#.###...#.\r\n" + 
			"#.........\r\n" + 
			".........#\r\n" + 
			".#.......#\r\n" + 
			"##........\r\n" + 
			"#.##.....#\r\n" + 
			"##.#..##.#\r\n" + 
			"\r\n" + 
			"Tile 2383:\r\n" + 
			"#..##..#..\r\n" + 
			"..#...#..#\r\n" + 
			"#...#.#.##\r\n" + 
			"#.##.....#\r\n" + 
			"....#..#..\r\n" + 
			"...#.##..#\r\n" + 
			"...#.....#\r\n" + 
			"..###.#...\r\n" + 
			"....##..#.\r\n" + 
			"#...###..#\r\n" + 
			"\r\n" + 
			"Tile 2591:\r\n" + 
			"##...##.##\r\n" + 
			"..#..#.#..\r\n" + 
			"...#.....#\r\n" + 
			"#.###.....\r\n" + 
			".....####.\r\n" + 
			"...###.#..\r\n" + 
			"..#....#..\r\n" + 
			"#.........\r\n" + 
			"....##...#\r\n" + 
			"###.###.##\r\n" + 
			"\r\n" + 
			"Tile 1153:\r\n" + 
			"##.#...#.#\r\n" + 
			"###......#\r\n" + 
			"#....#.#..\r\n" + 
			"....#...##\r\n" + 
			"#...#...#.\r\n" + 
			"..##....##\r\n" + 
			"#..#...#..\r\n" + 
			"#........#\r\n" + 
			".#..#.####\r\n" + 
			"..##..#...\r\n" + 
			"\r\n" + 
			"Tile 1489:\r\n" + 
			"#.#.###..#\r\n" + 
			"##.#.#..##\r\n" + 
			".#..##..#.\r\n" + 
			"....#....#\r\n" + 
			"#.#..#.#..\r\n" + 
			".#.......#\r\n" + 
			"#......#..\r\n" + 
			"##.....#.#\r\n" + 
			"....##.##.\r\n" + 
			"#....#####\r\n" + 
			"\r\n" + 
			"Tile 1193:\r\n" + 
			"##..###...\r\n" + 
			"##.#......\r\n" + 
			"......#..#\r\n" + 
			"##......#.\r\n" + 
			"#....#####\r\n" + 
			".#.#....##\r\n" + 
			"...#..#..#\r\n" + 
			"#..#......\r\n" + 
			"##....##.#\r\n" + 
			"########..\r\n" + 
			"\r\n" + 
			"Tile 1163:\r\n" + 
			"##.....###\r\n" + 
			".#.......#\r\n" + 
			"#...#.##..\r\n" + 
			"#..#...#..\r\n" + 
			"...##.#...\r\n" + 
			".........#\r\n" + 
			"....#...##\r\n" + 
			".####.#...\r\n" + 
			"#.#.......\r\n" + 
			".#..##.###\r\n" + 
			"\r\n" + 
			"Tile 2137:\r\n" + 
			"##..#..#..\r\n" + 
			".#.#...#.#\r\n" + 
			"#........#\r\n" + 
			"#.........\r\n" + 
			"..#.......\r\n" + 
			"#...#....#\r\n" + 
			"..##.....#\r\n" + 
			"#....#.#..\r\n" + 
			"..#......#\r\n" + 
			"..##.##...\r\n" + 
			"\r\n" + 
			"Tile 1559:\r\n" + 
			"#..##..#.#\r\n" + 
			".........#\r\n" + 
			"#..##.##..\r\n" + 
			"#........#\r\n" + 
			"#..#..#..#\r\n" + 
			"....#...##\r\n" + 
			"...#.....#\r\n" + 
			"#......#..\r\n" + 
			".#........\r\n" + 
			"###..####.\r\n" + 
			"\r\n" + 
			"Tile 2521:\r\n" + 
			".###..#...\r\n" + 
			"#..#......\r\n" + 
			"....#.#.#.\r\n" + 
			"#.....#.##\r\n" + 
			".#..#...#.\r\n" + 
			".........#\r\n" + 
			"##...#...#\r\n" + 
			"#...#.....\r\n" + 
			"#..##.#.#.\r\n" + 
			"##..######\r\n" + 
			"\r\n" + 
			"Tile 1171:\r\n" + 
			"..#####.##\r\n" + 
			"..##.....#\r\n" + 
			".....#....\r\n" + 
			"#.#.....##\r\n" + 
			"#.#...#..#\r\n" + 
			"#.##..#..#\r\n" + 
			"#####....#\r\n" + 
			"#..#.##...\r\n" + 
			"##.......#\r\n" + 
			"#.#.#.....\r\n" + 
			"\r\n" + 
			"Tile 1361:\r\n" + 
			"..##.###.#\r\n" + 
			".....##..#\r\n" + 
			"###....#..\r\n" + 
			"..........\r\n" + 
			"#.......##\r\n" + 
			"#..#.....#\r\n" + 
			"#.........\r\n" + 
			".#.....#..\r\n" + 
			".......#.#\r\n" + 
			"..##..#...\r\n" + 
			"\r\n" + 
			"Tile 1259:\r\n" + 
			"#.##..####\r\n" + 
			"#...#..#..\r\n" + 
			"..###....#\r\n" + 
			"....#....#\r\n" + 
			"...###....\r\n" + 
			"...#..#.##\r\n" + 
			"#.#.##....\r\n" + 
			"##..##...#\r\n" + 
			"##....#..#\r\n" + 
			"#.###..##.\r\n" + 
			"\r\n" + 
			"Tile 1987:\r\n" + 
			"##.###..#.\r\n" + 
			".....#.#.#\r\n" + 
			"#......#.#\r\n" + 
			"#......#.#\r\n" + 
			"..#.#.....\r\n" + 
			".#..#....#\r\n" + 
			".####.##..\r\n" + 
			"..##.###.#\r\n" + 
			"#........#\r\n" + 
			".....#....\r\n" + 
			"\r\n" + 
			"Tile 2777:\r\n" + 
			"#.#.##..#.\r\n" + 
			"#...#.#..#\r\n" + 
			"..#......#\r\n" + 
			"...##.....\r\n" + 
			"#.#......#\r\n" + 
			"#........#\r\n" + 
			"#....#....\r\n" + 
			".......##.\r\n" + 
			".....#..##\r\n" + 
			"#..##.#..#\r\n" + 
			"\r\n" + 
			"Tile 3673:\r\n" + 
			"...###.###\r\n" + 
			"###..#...#\r\n" + 
			"..........\r\n" + 
			"..#.#.##..\r\n" + 
			"#.#..#....\r\n" + 
			"#......#.#\r\n" + 
			"..##......\r\n" + 
			".#...#.#..\r\n" + 
			"#......#.#\r\n" + 
			"##..#..##.\r\n" + 
			"\r\n" + 
			"Tile 2819:\r\n" + 
			"#.##.#####\r\n" + 
			"#.....#.#.\r\n" + 
			"####...#.#\r\n" + 
			".....#...#\r\n" + 
			"#...#.#.#.\r\n" + 
			"#..#...###\r\n" + 
			"......#..#\r\n" + 
			"....#.#...\r\n" + 
			".....#.#..\r\n" + 
			"..#######.\r\n" + 
			"\r\n" + 
			"Tile 1699:\r\n" + 
			"###....#.#\r\n" + 
			"......#..#\r\n" + 
			"#.........\r\n" + 
			"......#..#\r\n" + 
			"#...#.##..\r\n" + 
			"...#.....#\r\n" + 
			".........#\r\n" + 
			"...##..#.#\r\n" + 
			"#.........\r\n" + 
			".#.....##.\r\n" + 
			"\r\n" + 
			"Tile 2351:\r\n" + 
			".#####.#.#\r\n" + 
			"##....##..\r\n" + 
			"###...#.#.\r\n" + 
			"..#.#....#\r\n" + 
			".........#\r\n" + 
			".#.#.....#\r\n" + 
			"..#...##..\r\n" + 
			"#..#.#....\r\n" + 
			"........##\r\n" + 
			"###.#...##\r\n" + 
			"\r\n" + 
			"Tile 1399:\r\n" + 
			".###...#..\r\n" + 
			"#.#......#\r\n" + 
			".##....#.#\r\n" + 
			"...#..#...\r\n" + 
			"#.#.#..##.\r\n" + 
			"#.......#.\r\n" + 
			"#....#..##\r\n" + 
			"....#...#.\r\n" + 
			"#.....#..#\r\n" + 
			"..#..#.#.#\r\n" + 
			"\r\n" + 
			"Tile 3793:\r\n" + 
			"##..####.#\r\n" + 
			".##...#..#\r\n" + 
			"#.....#..#\r\n" + 
			"#...#.....\r\n" + 
			".....#...#\r\n" + 
			"..........\r\n" + 
			"#....#...#\r\n" + 
			"...##..#..\r\n" + 
			".#..##....\r\n" + 
			"....#.#.##\r\n" + 
			"\r\n" + 
			"Tile 3701:\r\n" + 
			".....##.#.\r\n" + 
			"#..#.##...\r\n" + 
			"........##\r\n" + 
			".........#\r\n" + 
			"#..##...#.\r\n" + 
			"#...#.#..#\r\n" + 
			"..#..#.#..\r\n" + 
			"#.....####\r\n" + 
			"#...#..##.\r\n" + 
			"...#..###.\r\n" + 
			"\r\n" + 
			"Tile 2707:\r\n" + 
			"#.###.#.#.\r\n" + 
			"#......#..\r\n" + 
			"####...#..\r\n" + 
			"..........\r\n" + 
			"#.#..##..#\r\n" + 
			"#####..#.#\r\n" + 
			"#..#..#.#.\r\n" + 
			"###......#\r\n" + 
			"#..#..#.#.\r\n" + 
			"....#.#...\r\n" + 
			"\r\n" + 
			"Tile 3559:\r\n" + 
			"##.#.##.##\r\n" + 
			"#....#...#\r\n" + 
			"...##..#.#\r\n" + 
			"..#.##....\r\n" + 
			".....#....\r\n" + 
			"..##..#.##\r\n" + 
			"....#.....\r\n" + 
			"......##..\r\n" + 
			"...###....\r\n" + 
			"#.##...#..\r\n" + 
			"\r\n" + 
			"Tile 2381:\r\n" + 
			"..#...#.##\r\n" + 
			"..#...#.#.\r\n" + 
			"###...#...\r\n" + 
			"##..##....\r\n" + 
			"....#.##.#\r\n" + 
			"...#......\r\n" + 
			".#..#....#\r\n" + 
			"..........\r\n" + 
			"##....#..#\r\n" + 
			"###.#.##.#\r\n" + 
			"\r\n" + 
			"Tile 1973:\r\n" + 
			".#...##...\r\n" + 
			"#.#.#...##\r\n" + 
			"#....#..##\r\n" + 
			"#......###\r\n" + 
			"......#..#\r\n" + 
			".........#\r\n" + 
			"...##..###\r\n" + 
			".##..#..#.\r\n" + 
			"#.....##.#\r\n" + 
			"...##..###\r\n" + 
			"\r\n" + 
			"Tile 3607:\r\n" + 
			"#..#####..\r\n" + 
			".#.###.#.#\r\n" + 
			"...##...#.\r\n" + 
			"..#......#\r\n" + 
			".#.#......\r\n" + 
			"##.#....##\r\n" + 
			"###....#..\r\n" + 
			"#...#...##\r\n" + 
			".#.....#..\r\n" + 
			"#####..#..\r\n" + 
			"\r\n" + 
			"Tile 2251:\r\n" + 
			"##..#..#..\r\n" + 
			"#........#\r\n" + 
			".........#\r\n" + 
			"...#...#..\r\n" + 
			"#.......##\r\n" + 
			".#.#..#..#\r\n" + 
			".##.##...#\r\n" + 
			"###...##..\r\n" + 
			"#........#\r\n" + 
			"#.#..#####\r\n" + 
			"\r\n" + 
			"Tile 3947:\r\n" + 
			"..#.##..##\r\n" + 
			"###.......\r\n" + 
			"#.#..#....\r\n" + 
			"#.#......#\r\n" + 
			"#.#...#...\r\n" + 
			"##.#.##..#\r\n" + 
			"....##....\r\n" + 
			"...##.#...\r\n" + 
			"#.#.....#.\r\n" + 
			".##.#####.\r\n" + 
			"\r\n" + 
			"Tile 3259:\r\n" + 
			".#.#####..\r\n" + 
			".....#.#..\r\n" + 
			"##........\r\n" + 
			".....#....\r\n" + 
			"#.#.......\r\n" + 
			".........#\r\n" + 
			"......#...\r\n" + 
			"......#..#\r\n" + 
			".##.......\r\n" + 
			"#..#.##.##\r\n" + 
			"\r\n" + 
			"Tile 3761:\r\n" + 
			".#....####\r\n" + 
			".##..#...#\r\n" + 
			"........#.\r\n" + 
			"###.#.....\r\n" + 
			"#.....#..#\r\n" + 
			"..##....##\r\n" + 
			"........##\r\n" + 
			"...#..#..#\r\n" + 
			"...#.#....\r\n" + 
			"###.######\r\n" + 
			"\r\n" + 
			"Tile 2473:\r\n" + 
			"#..###...#\r\n" + 
			"##.....##.\r\n" + 
			"#..###....\r\n" + 
			"##....##..\r\n" + 
			".....#.#..\r\n" + 
			"#.......#.\r\n" + 
			"..#.....#.\r\n" + 
			"......##..\r\n" + 
			"....#....#\r\n" + 
			"#...#.#...\r\n" + 
			"\r\n" + 
			"Tile 2767:\r\n" + 
			"##.##.#.#.\r\n" + 
			".#.####...\r\n" + 
			"..##....##\r\n" + 
			"#...#.....\r\n" + 
			"..#..#...#\r\n" + 
			"#.........\r\n" + 
			"#........#\r\n" + 
			"#...###...\r\n" + 
			"#.#...##.#\r\n" + 
			".###..##..\r\n" + 
			"\r\n" + 
			"Tile 2281:\r\n" + 
			"#...#..#.#\r\n" + 
			"...#......\r\n" + 
			".........#\r\n" + 
			"#....#....\r\n" + 
			".......#..\r\n" + 
			".....##..#\r\n" + 
			"#.#....#.#\r\n" + 
			"##..##...#\r\n" + 
			"........##\r\n" + 
			"#....#...#\r\n" + 
			"\r\n" + 
			"Tile 1693:\r\n" + 
			"#.##.#####\r\n" + 
			"......#...\r\n" + 
			"#.#...##..\r\n" + 
			"....#.#.#.\r\n" + 
			"#..#...###\r\n" + 
			"##.##.##.#\r\n" + 
			"..#...####\r\n" + 
			"#..##....#\r\n" + 
			"#......#.#\r\n" + 
			"#....###.#\r\n" + 
			"\r\n" + 
			"Tile 2417:\r\n" + 
			".###.##.#.\r\n" + 
			"##...#...#\r\n" + 
			"#..#..##.#\r\n" + 
			"#...#..#..\r\n" + 
			".........#\r\n" + 
			"...#.....#\r\n" + 
			"..##.#..#.\r\n" + 
			"#.........\r\n" + 
			"....##....\r\n" + 
			"#.##.###.#\r\n" + 
			"\r\n" + 
			"Tile 2879:\r\n" + 
			"..#.#..#..\r\n" + 
			"..##..#.#.\r\n" + 
			"##......##\r\n" + 
			"#..##...##\r\n" + 
			"#.##..#...\r\n" + 
			"#.......#.\r\n" + 
			".......#.#\r\n" + 
			"##..#..#.#\r\n" + 
			"#...#....#\r\n" + 
			"#....#.##.\r\n" + 
			"\r\n" + 
			"Tile 2851:\r\n" + 
			".......#.#\r\n" + 
			"....#.....\r\n" + 
			"##.###.##.\r\n" + 
			".......#..\r\n" + 
			".#..###..#\r\n" + 
			"....###..#\r\n" + 
			"#..#......\r\n" + 
			"...#.#...#\r\n" + 
			".#.###...#\r\n" + 
			"###.###.##\r\n" + 
			"\r\n" + 
			"Tile 3931:\r\n" + 
			".....##.##\r\n" + 
			"###....#..\r\n" + 
			"#..#....##\r\n" + 
			"#.#.....##\r\n" + 
			"##...#....\r\n" + 
			"#..##..#.#\r\n" + 
			".......#.#\r\n" + 
			"...#..#.##\r\n" + 
			".#...#....\r\n" + 
			"##....#.##\r\n" + 
			"\r\n" + 
			"Tile 3181:\r\n" + 
			"...##...#.\r\n" + 
			"....#....#\r\n" + 
			"#......#.#\r\n" + 
			"#.###....#\r\n" + 
			"##.......#\r\n" + 
			".#..#.#..#\r\n" + 
			"###..#.#..\r\n" + 
			"#....#.#..\r\n" + 
			"#.......##\r\n" + 
			"###..###..\r\n" + 
			"\r\n" + 
			"Tile 2647:\r\n" + 
			"#..#..#.##\r\n" + 
			"#........#\r\n" + 
			"#..#..##..\r\n" + 
			".....#...#\r\n" + 
			"....##.#.#\r\n" + 
			"#..###...#\r\n" + 
			"..#......#\r\n" + 
			"#.#..###..\r\n" + 
			"#.......##\r\n" + 
			"####...#..\r\n" + 
			"\r\n" + 
			"Tile 2441:\r\n" + 
			"..#..###..\r\n" + 
			"##..###..#\r\n" + 
			"##.##...#.\r\n" + 
			"#.##.....#\r\n" + 
			".......###\r\n" + 
			"...#...###\r\n" + 
			"#...#.....\r\n" + 
			".#..####.#\r\n" + 
			".#.#.#..#.\r\n" + 
			"#.#.##.#..\r\n" + 
			"\r\n" + 
			"Tile 3733:\r\n" + 
			"...#....##\r\n" + 
			"..#..##..#\r\n" + 
			".....#..#.\r\n" + 
			"##........\r\n" + 
			"..#....#..\r\n" + 
			"#....##.##\r\n" + 
			".#....#..#\r\n" + 
			".#.##.##..\r\n" + 
			"#.##..#.#.\r\n" + 
			".#..####.#\r\n" + 
			"\r\n" + 
			"Tile 1607:\r\n" + 
			"#.#.#.#.##\r\n" + 
			"#.........\r\n" + 
			".....#....\r\n" + 
			".#.#..#..#\r\n" + 
			"..#......#\r\n" + 
			"#.....#...\r\n" + 
			"#.#..#....\r\n" + 
			"......#.##\r\n" + 
			"#.##...#..\r\n" + 
			"..#.######\r\n" + 
			"\r\n" + 
			"Tile 3301:\r\n" + 
			"....##...#\r\n" + 
			"#..##....#\r\n" + 
			"....#.....\r\n" + 
			"#.....###.\r\n" + 
			"#....##.#.\r\n" + 
			"#.#...#..#\r\n" + 
			"......##.#\r\n" + 
			"...##.....\r\n" + 
			".........#\r\n" + 
			"..#######.\r\n" + 
			"\r\n" + 
			"Tile 1109:\r\n" + 
			"..#...###.\r\n" + 
			".#.......#\r\n" + 
			"#.....#...\r\n" + 
			"..........\r\n" + 
			"##.#.#....\r\n" + 
			"#...##....\r\n" + 
			"#.....###.\r\n" + 
			".#....####\r\n" + 
			".#....#.##\r\n" + 
			"###.#...#.\r\n" + 
			"\r\n" + 
			"Tile 2789:\r\n" + 
			".#.#.####.\r\n" + 
			"..........\r\n" + 
			"#...#.#.#.\r\n" + 
			"#..#....##\r\n" + 
			".....##...\r\n" + 
			".#..##.#.#\r\n" + 
			"........##\r\n" + 
			"#.#.#.#...\r\n" + 
			"......#.##\r\n" + 
			"#...#..#..\r\n" + 
			"\r\n" + 
			"Tile 2593:\r\n" + 
			"...#.#.#.#\r\n" + 
			"#......###\r\n" + 
			"..#.##....\r\n" + 
			"#.......#.\r\n" + 
			"...#.#...#\r\n" + 
			"#..##....#\r\n" + 
			"#..##.....\r\n" + 
			"#.##.#...#\r\n" + 
			"#..###..#.\r\n" + 
			".#....###.\r\n" + 
			"\r\n" + 
			"Tile 2539:\r\n" + 
			"...###..#.\r\n" + 
			"..........\r\n" + 
			".........#\r\n" + 
			".....###..\r\n" + 
			".......#..\r\n" + 
			"......#.#.\r\n" + 
			".#..#...##\r\n" + 
			"#....#.#..\r\n" + 
			"##...#....\r\n" + 
			".###.#.#.#\r\n" + 
			"\r\n" + 
			"Tile 3307:\r\n" + 
			"##.##.#...\r\n" + 
			".#..#.....\r\n" + 
			"#..#..#..#\r\n" + 
			"#.....##.#\r\n" + 
			"..#.#.....\r\n" + 
			"##....##..\r\n" + 
			".....#....\r\n" + 
			"#..#.#....\r\n" + 
			"######...#\r\n" + 
			"####.#....\r\n" + 
			"\r\n" + 
			"Tile 1613:\r\n" + 
			"###..###.#\r\n" + 
			"...#...#..\r\n" + 
			"#.#..##...\r\n" + 
			"......##.#\r\n" + 
			"......#..#\r\n" + 
			"..##......\r\n" + 
			"#.....#..#\r\n" + 
			"##.#..##.#\r\n" + 
			"###...#..#\r\n" + 
			"#.#..##.#.\r\n" + 
			"\r\n" + 
			"Tile 3727:\r\n" + 
			"..#...#.##\r\n" + 
			"#.#......#\r\n" + 
			"#.###...##\r\n" + 
			"..####..#.\r\n" + 
			"#.........\r\n" + 
			".....#...#\r\n" + 
			"#..##....#\r\n" + 
			"#.#.....##\r\n" + 
			"#....###.#\r\n" + 
			"..#..##.##\r\n" + 
			"\r\n" + 
			"Tile 2017:\r\n" + 
			"#...##..##\r\n" + 
			"#..#..##.#\r\n" + 
			"#........#\r\n" + 
			".....#..##\r\n" + 
			"#..#.....#\r\n" + 
			"....#....#\r\n" + 
			"#....#....\r\n" + 
			".##.......\r\n" + 
			".......#..\r\n" + 
			"#..##..#..\r\n" + 
			"\r\n" + 
			"Tile 1933:\r\n" + 
			"###.#.....\r\n" + 
			"#.#.####..\r\n" + 
			"..#..##...\r\n" + 
			"##..###..#\r\n" + 
			"###..#.###\r\n" + 
			"..#.#....#\r\n" + 
			"#.........\r\n" + 
			"..#..#.###\r\n" + 
			"#.#..###..\r\n" + 
			"...#.#.#..\r\n" + 
			"\r\n" + 
			"Tile 2239:\r\n" + 
			".#.#..#.##\r\n" + 
			"...#.##..#\r\n" + 
			"#...#....#\r\n" + 
			"#..#......\r\n" + 
			"#....#..#.\r\n" + 
			"#..##..#.#\r\n" + 
			"..#.#.#..#\r\n" + 
			"#....#..#.\r\n" + 
			"#...#.#...\r\n" + 
			".#.##.####\r\n" + 
			"\r\n" + 
			"Tile 3449:\r\n" + 
			".##...###.\r\n" + 
			"..#......#\r\n" + 
			".......#.#\r\n" + 
			"..##......\r\n" + 
			"#.###.##.#\r\n" + 
			"....##.#..\r\n" + 
			"........#.\r\n" + 
			"##.#......\r\n" + 
			"...#.#....\r\n" + 
			"..###....#\r\n" + 
			"\r\n" + 
			"Tile 2347:\r\n" + 
			"..##....#.\r\n" + 
			"#.........\r\n" + 
			"..........\r\n" + 
			"....#.#..#\r\n" + 
			".........#\r\n" + 
			"##.##.#..#\r\n" + 
			"......#..#\r\n" + 
			".#.##...#.\r\n" + 
			"#.#####.##\r\n" + 
			".#.#....##\r\n" + 
			"\r\n" + 
			"Tile 3023:\r\n" + 
			"#...#.##..\r\n" + 
			".......#..\r\n" + 
			"#.#..#.##.\r\n" + 
			"#...#.#..#\r\n" + 
			"..#.#...##\r\n" + 
			"#.##...##.\r\n" + 
			"......##..\r\n" + 
			".....#####\r\n" + 
			".#...##...\r\n" + 
			"#..#.#....\r\n" + 
			"\r\n" + 
			"Tile 3541:\r\n" + 
			"###.######\r\n" + 
			"..#.....#.\r\n" + 
			"#....###..\r\n" + 
			"......#...\r\n" + 
			"..#..##..#\r\n" + 
			"#........#\r\n" + 
			"#..#......\r\n" + 
			"###..#.##.\r\n" + 
			"..#....#.#\r\n" + 
			"#..###.#.#\r\n" + 
			"\r\n" + 
			"Tile 3709:\r\n" + 
			"##.#.##..#\r\n" + 
			"#.........\r\n" + 
			".##.##...#\r\n" + 
			".#..#.#..#\r\n" + 
			"#.......##\r\n" + 
			"......#...\r\n" + 
			".#..#.....\r\n" + 
			".......#.#\r\n" + 
			"#..##....#\r\n" + 
			".##.......\r\n" + 
			"\r\n" + 
			"Tile 1657:\r\n" + 
			"#.##.#...#\r\n" + 
			"...#.#..#.\r\n" + 
			".....#..##\r\n" + 
			".....#.#..\r\n" + 
			"######.###\r\n" + 
			"##........\r\n" + 
			"......#..#\r\n" + 
			"#..#...#..\r\n" + 
			".......#..\r\n" + 
			"...#....#.\r\n" + 
			"\r\n" + 
			"Tile 1031:\r\n" + 
			"####.#.##.\r\n" + 
			"..........\r\n" + 
			".#...#..#.\r\n" + 
			"...#.....#\r\n" + 
			".##.#....#\r\n" + 
			"....#.##..\r\n" + 
			"........##\r\n" + 
			"#..#..#.##\r\n" + 
			"#.##.....#\r\n" + 
			"#.####...#\r\n" + 
			"\r\n" + 
			"Tile 3691:\r\n" + 
			".#.#######\r\n" + 
			"........##\r\n" + 
			"#.#.......\r\n" + 
			"#..##..#..\r\n" + 
			"#.#.##.##.\r\n" + 
			"....###.#.\r\n" + 
			".#..#..#..\r\n" + 
			"..#.##.#..\r\n" + 
			".....#....\r\n" + 
			"##.###...#\r\n" + 
			"";
	
	private static final class Tile {
		private final Integer id;
		private final char[][] grid;
		
		public static char[][] toGrid(List<char[]> strings) {
			return strings.toArray(new char[strings.size()][]);
		}
		
		public Tile(Integer id, char[][] grid) {
			this.id = id;
			this.grid = grid;
		}
		
		public Integer getId() {
			return id;
		}

		private Edge getTopEdge() {
			return Edge.top(new String(grid[0]));
		}

		private Edge getTopEdgeReversed() {
			return Edge.topReversed(new StringBuilder(getTopEdge().getPixels()).reverse().toString());
		}

		private Edge getBottomEdge() {
			return Edge.bottom(new String(grid[grid.length-1]));
		}

		private Edge getBottomEdgeReversed() {
			return Edge.bottomReversed(new StringBuilder(getBottomEdge().getPixels()).reverse().toString());
		}
		
		private Edge getLeftEdge() {
			return Edge.left(getColumn(0));
		}
		
		private Edge getLeftEdgeReversed() {
			return Edge.leftReversed(new StringBuilder(getLeftEdge().getPixels()).reverse().toString());
		}
		
		private Edge getRightEdge() {
			return Edge.right(getColumn(grid.length-1));
		}
		
		private Edge getRightEdgeReversed() {
			return Edge.rightReversed(new StringBuilder(getRightEdge().getPixels()).reverse().toString());
		}
		
		private String getColumn(int col) {
			final char [] column = new char[grid.length];
			for (int i = 0; i < grid[0].length; i++) {
				column[i] = grid[i][col];								
			}
			return new String(column);
		}
		
		private List<String> getRows() {
			return Stream.of(grid).map(String::valueOf).collect(toList());
		}
		
		public Set<Edge> getAllEdges() {
			return Set.of(
					getTopEdge(), 
					getBottomEdge(), 
					getLeftEdge(), 
					getRightEdge()
			);
		}

		public Set<Edge> getAllEdgesReversed() {
			return Set.of(
					getTopEdgeReversed(), 
					getBottomEdgeReversed(), 
					getLeftEdgeReversed(), 
					getRightEdgeReversed()
			);
		}
		
		public Set<Pair<Edge, Edge>> getCommonEdges(Tile other) {
			return union(this.getAllEdges(), this.getAllEdgesReversed()).stream()
					.flatMap(selfEdge -> union(other.getAllEdges(), other.getAllEdgesReversed()).stream()
											.filter(otherEdge -> otherEdge.matches(selfEdge))
											.map(otherEdge -> Pair.of(selfEdge, otherEdge)))
					.collect(toSet());
		}
		
		@SuppressWarnings("unused")
		public Tile getFlippedHorizontally() {
			final List<char[]> newGrid = getRows().stream()
					.map(s -> new StringBuilder(s).reverse().toString().toCharArray())
					.collect(toList());			
			return new Tile(id, Tile.toGrid(newGrid));
		}
		
		@SuppressWarnings("unused")
		public Tile getFlippedVertically() {
			final List<char[]> newGrid = new ArrayList<>();
	        final ListIterator<String> iterator = getRows().listIterator(grid.length);
	        while (iterator.hasPrevious()) {
	        	newGrid.add(iterator.previous().toCharArray());
	        }
	        return new Tile(id, Tile.toGrid(newGrid));
		}

		@Override
		public String toString() {
			final StringBuilder sb = new StringBuilder();
			sb.append("Tile ").append(this.id).append(":").append(System.lineSeparator());
			for (char[] cs : grid) {
				sb.append(new String(cs)).append(System.lineSeparator());
			}
			return sb.toString();
		}

		@Override
		public int hashCode() {
			return Objects.hash(id);
		}

		@Override
		public boolean equals(Object obj) {
			if (this == obj) {
				return true;
			}
			if (!(obj instanceof Tile)) {
				return false;
			}
			final Tile other = (Tile) obj;
			return Objects.equals(id, other.id);
		}
		
		private static final class Edge {
			public enum EdgeType {
				TOP, RIGHT, BOTTOM, LEFT, TOP_REVERSED, RIGHT_REVERSED, BOTTOM_REVERSED, LEFT_REVERSED
			}
			
			private final EdgeType type;
			private final String pixels;
			
			private Edge(EdgeType type, String pixels) {
				this.type = type;
				this.pixels = pixels;
			}
			
			public static Edge top(String pixels) {
				return new Edge(EdgeType.TOP, pixels);
			}
			
			public static Edge topReversed(String pixels) {
				return new Edge(EdgeType.TOP_REVERSED, pixels);
			}
			
			public static Edge right(String pixels) {
				return new Edge(EdgeType.RIGHT, pixels);
			}
			
			public static Edge rightReversed(String pixels) {
				return new Edge(EdgeType.RIGHT_REVERSED, pixels);
			}
			
			public static Edge left(String pixels) {
				return new Edge(EdgeType.LEFT, pixels);
			}
			
			public static Edge leftReversed(String pixels) {
				return new Edge(EdgeType.LEFT_REVERSED, pixels);
			}
			
			public static Edge bottom(String pixels) {
				return new Edge(EdgeType.BOTTOM, pixels);
			}
			
			public static Edge bottomReversed(String pixels) {
				return new Edge(EdgeType.BOTTOM_REVERSED, pixels);
			}

			public EdgeType getType() {
				return type;
			}

			public String getPixels() {
				return pixels;
			}
			
			public boolean matches(Edge other) {
				return Objects.equals(this.pixels, other.pixels);
			}

			@Override
			public String toString() {
				return "Edge [type=" + type + ", pixels=" + pixels + "]";
			}

			@Override
			public int hashCode() {
				return Objects.hash(pixels, type);
			}

			@Override
			public boolean equals(Object obj) {
				if (this == obj) {
					return true;
				}
				if (!(obj instanceof Edge)) {
					return false;
				}
				Edge other = (Edge) obj;
				return Objects.equals(this.pixels, other.pixels) && this.type == other.type;
			}
		}
	}
	
	private static final class Image {
		private final Set<Tile> tiles;

		public Image(Set<Tile> tiles) {
			this.tiles = tiles;
		}

		public Set<Tile> getTiles() {
			return tiles;
		}
		
		public Map<Tile, Map<Tile, Set<Pair<Tile.Edge, Tile.Edge>>>> getAllCommonEdges() {
			final Map<Tile, Map<Tile, Set<Pair<Tile.Edge, Tile.Edge>>>> commons = new HashMap<>();
			for (Tile tile1 : getTiles()) {
				commons.put(tile1, new HashMap<Tile, Set<Pair<Tile.Edge, Tile.Edge>>>());
				for (Tile tile2 : getTiles()) {
					if (tile1.getId() == tile2.getId()) {
						continue;
					}
					final Set<Pair<Tile.Edge, Tile.Edge>> common = tile1.getCommonEdges(tile2);
					if (!common.isEmpty()) {
						commons.get(tile1).put(tile2, common);
					}
				}
			}
			return commons;
		}
		
		private Set<Tile> filterCommonEdgesByCount(Map<Tile, Map<Tile, Set<Pair<Tile.Edge, Tile.Edge>>>> commons, int count) {
			return getAllCommonEdges().entrySet().stream()
					.filter(e -> e.getValue().size() == count)
					.map(Map.Entry::getKey)
					.collect(toSet());
		}
		
		public Set<Tile> findCorners() {
			return filterCommonEdgesByCount(getAllCommonEdges(), 2);
		}

		public void lockTopLeftCorner() {
			final Map<Tile, Map<Tile, Set<Pair<Tile.Edge, Tile.Edge>>>> commons = getAllCommonEdges();
			final Set<Tile> corners = filterCommonEdgesByCount(commons, 2);
			for (Tile corner : corners) {
				Tile rightAdjacent = null;
				Tile rightAdjacentFlipped= null;
				for (Tile adjacent : commons.get(corner).keySet()) {
					final Set<Pair<Tile.Edge, Tile.Edge>> pairs = commons.get(corner).get(adjacent);
					assert pairs.size() == 2;
					final Set<Pair<Tile.Edge.EdgeType, Tile.Edge.EdgeType>> types = pairs.stream()
							.map(p -> Pair.of(p.getLeft().getType(), p.getRight().getType()))
							.collect(toSet());
					assert types.size() == 2;
					if (types.contains(Pair.of(Tile.Edge.EdgeType.RIGHT, Tile.Edge.EdgeType.LEFT))
							&& types.contains(Pair.of(Tile.Edge.EdgeType.RIGHT_REVERSED, Tile.Edge.EdgeType.LEFT_REVERSED))) {
						rightAdjacent = adjacent;
						break;
					} else if (types.contains(Pair.of(Tile.Edge.EdgeType.LEFT, Tile.Edge.EdgeType.RIGHT))
							&& types.contains(Pair.of(Tile.Edge.EdgeType.LEFT_REVERSED, Tile.Edge.EdgeType.RIGHT_REVERSED))) {
						rightAdjacentFlipped = adjacent;
						break;
					}
				}
				Tile bottomAdjacent = null;
				Tile bottomAdjacentFlipped = null;
				for (Tile adjacent : commons.get(corner).keySet()) {
					final Set<Pair<Tile.Edge, Tile.Edge>> pairs = commons.get(corner).get(adjacent);
					assert pairs.size() == 2;
					final Set<Pair<Tile.Edge.EdgeType, Tile.Edge.EdgeType>> types = pairs.stream()
							.map(p -> Pair.of(p.getLeft().getType(), p.getRight().getType()))
							.collect(toSet());
					assert types.size() == 2;
					if (types.contains(Pair.of(Tile.Edge.EdgeType.BOTTOM, Tile.Edge.EdgeType.TOP))
							&& types.contains(Pair.of(Tile.Edge.EdgeType.BOTTOM_REVERSED, Tile.Edge.EdgeType.TOP_REVERSED))) {
						bottomAdjacent = adjacent;
						break;
					} else if (types.contains(Pair.of(Tile.Edge.EdgeType.TOP, Tile.Edge.EdgeType.BOTTOM))
							&& types.contains(Pair.of(Tile.Edge.EdgeType.TOP_REVERSED, Tile.Edge.EdgeType.BOTTOM_REVERSED))) {
						bottomAdjacentFlipped = adjacent;
						break;
					}
				}
				System.out.println("================================");
				System.out.println(corner);
				System.out.println(rightAdjacent);
				System.out.println(rightAdjacentFlipped);
				System.out.println(bottomAdjacent);
				System.out.println(bottomAdjacentFlipped);
				if (rightAdjacent != null) {
					if (bottomAdjacent != null) {
						// OK - lock 3 tiles
					} else {
//						assert bottomAdjacentFlipped != null;
						// horizontally flip all 3 tiles and lock
					}
				} else {
//					assert rightAdjacentFlipped != null;
					if (bottomAdjacent != null) {
						// vertically flip all 3 tiles and lock
					} else {
						// horizontally and vertically flip all 3 tiles and lock ?
					}
				}
			}
		}
	}
	
	private static final class Math {
		
		public static long prod(Collection<Integer> numbers) {
			if (CollectionUtils.isEmpty(numbers)) {
				return 0L;
			}
			final MutableLong result = new MutableLong(1L);
			numbers.forEach(n -> result.setValue(result.longValue() * n));
			return result.longValue();
		}
	}
}
